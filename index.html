// 放在 showCurrentSentence() 組完 innerHTML 之後：
const fbPanel = document.getElementById('feedback-panel');
fbPanel.classList.remove('hidden');

function renderFeedbackStatus(msg){
  const s = document.getElementById('feedback-status');
  const r = document.getElementById('feedback-result');
  s.textContent = msg;
  s.style.display = 'block';
  r.style.display = 'none';
}
window.renderFeedbackStatus = renderFeedbackStatus;

function renderFeedbackResult(res){
  const s = document.getElementById('feedback-status');
  const r = document.getElementById('feedback-result');

  document.getElementById('fb-total').textContent = res.scores.total;
  document.getElementById('fb-acc').textContent   = res.scores.accuracy;
  document.getElementById('fb-flu').textContent   = res.scores.fluency;
  document.getElementById('fb-pro').textContent   = res.scores.prosody;

  document.getElementById('fb-wpm').textContent   = res.metrics.wpm;
  document.getElementById('fb-pause').textContent = res.metrics.pauseRatio;
  document.getElementById('fb-pitch').textContent = res.metrics.pitchVar;

  const tipsUl = document.getElementById('fb-tips');
  tipsUl.innerHTML = '';
  res.tips.forEach(t=>{
    const li=document.createElement('li'); li.textContent=t; tipsUl.appendChild(li);
  });

  const note = document.getElementById('fb-note');
  note.textContent = res.notes?.[0] || '';
  s.style.display = 'none';
  r.style.display = 'block';
}
window.renderFeedbackResult = renderFeedbackResult;
